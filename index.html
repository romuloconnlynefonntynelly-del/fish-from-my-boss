<!DOCTYPE html>
<!--
  ARQUIVO: tanques_bloco1.html
  OBJETIVO:
  Este arquivo cria um mapa visual de 30 tanques (6 linhas x 5 colunas)
  no formato igual ao desenho do caderno (A–E e 1–6).

  IMPORTANTE:
  - Tudo está comentado em PORTUGUÊS.
  - Se você quiser mudar algo, leia os comentários que explicam
    para que serve cada parte.
-->
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mapa de Tanques — 6x5 (30 Tanques)</title>
  <style>
    :root{--bg:#f4fbff;--card:#fff;--accent:#0b76ff;--muted:#666}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, Arial, sans-serif;background:var(--bg);margin:0;padding:18px}
    header{display:flex;align-items:center;gap:12px;margin-bottom:18px}
    h1{font-size:20px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:14px}

    .wrapper{display:flex;gap:20px;flex-direction:column}

    .board-card{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 6px 18px rgba(10,30,60,0.06)}

    /* Grid area */
    .grid-wrap{display:flex;gap:12px;align-items:flex-start}
    /* row labels */
    .rows{display:flex;flex-direction:column;gap:12px;padding:40px 6px 6px 6px}
    .row-label{height:90px;display:flex;align-items:center;justify-content:center;font-weight:600;color:var(--muted)}

    /* main grid */
    .grid{display:grid;grid-template-columns:repeat(5, minmax(110px,1fr));gap:12px;padding:8px}
    .cell{background:#fefefe;border-radius:10px;padding:8px;min-height:90px;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;border:1px solid rgba(10,10,10,0.04);cursor:pointer}
    .cell .title{font-weight:700;margin-top:6px}
    .cell .subtitle{font-size:12px;color:var(--muted);margin-top:4px}
    .cell img{width:100%;height:60px;object-fit:cover;border-radius:6px;background:#eee}

    /* column labels under grid */
    .cols{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin-top:10px}
    .col-label{height:26px;display:flex;align-items:center;justify-content:center;font-weight:700}

    /* actions */
    .actions{display:flex;gap:8px;margin-top:12px}
    button{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:8px;cursor:pointer}
    button.ghost{background:#fff;color:var(--accent);border:1px solid rgba(11,118,255,0.12)}

    /* modal */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(10,10,10,0.4)}
    .modal.open{display:flex}
    .modal-content{width:95%;max-width:420px;background:#fff;padding:14px;border-radius:12px}
    .modal-content h3{margin:0 0 8px}
    .form-row{display:flex;flex-direction:column;gap:6px;margin-bottom:8px}
    input[type=text]{padding:8px;border-radius:8px;border:1px solid #ddd}
    input[type=file]{padding:6px}
    .preview{height:140px;background:#f2f5fb;border-radius:8px;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .preview img{width:100%;height:100%;object-fit:cover}

    footer{margin-top:14px;color:var(--muted);font-size:13px}

    @media (max-width:700px){.row-label{height:70px}.cell{min-height:80px}.grid{gap:8px}}
  </style>
</head>
<body>
  <header>
    <div>
      <h1>Mapa de Tanques — 30 unidades (6 x 5)</h1>
      <p class="lead">Clique em qualquer célula para adicionar o nome do peixe e uma foto. Os campos ficam salvos no seu navegador.</p>
    </div>
  </header>

  <div class="wrapper">
    <div class="board-card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong>Bloco 1 — 30 tanques</strong>
        
      </div>

      <div style="display:flex;gap:12px;margin-top:12px;align-items:flex-start">
        <div class="rows" aria-hidden="true">
          <!-- row numbers 1..6 -->
        </div>

        <div style="flex:1">
          <div class="grid" id="grid"></div>
          <div class="cols" aria-hidden="true">
            <!-- col labels A..E -->
          </div>
        </div>
      </div>

    </div>

    <footer>
      <div>Observação: os dados são salvos localmente no navegador (localStorage). Se quiser, depois eu te mostro como guardar num servidor.</div>
    </footer>
  </div>

  <!-- Modal de edição -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <h3 id="modalTitle">Editar tanque</h3>
      <div class="form-row">
        <label>Nome do Peixe (você deixa em branco se quiser)</label>
        <input type="text" id="fishName" placeholder="Ex.: Betta, Tilápia..." />
      </div>
      <div class="form-row">
        <label>Foto do Peixe (opcional)</label>
        <input type="file" id="fishImage" accept="image/*" />
      </div>
      <div class="form-row">
        <div class="preview" id="imagePreview">Sem imagem</div>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px">
        <button id="saveBtn">Salvar</button>
        <button id="cancelBtn" class="ghost">Cancelar</button>
      </div>
    </div>
  </div>

  <script>
    // Configuração: linhas e colunas para ter 30 tanques -> 6 linhas x 5 colunas (A..E)
    const rowsCount = 6;
    const cols = ['A','B','C','D','E'];
    const gridEl = document.getElementById('grid');
    const rowsEl = document.querySelector('.rows');
    const colsEl = document.querySelector('.cols');

    // cria labels das linhas
    for(let r=1;r<=rowsCount;r++){
      const div = document.createElement('div');
      div.className='row-label';
      div.textContent = r;
      rowsEl.appendChild(div);
    }

    // cria labels de colunas A..E
    cols.forEach(c=>{
      const d = document.createElement('div'); d.className='col-label'; d.textContent=c; colsEl.appendChild(d);
    });

    // dados na memória (inicial)
    let data = {};

    // Carrega de localStorage se existir
    const STORAGE_KEY = 'tanques_6x5_v1';
    const saved = localStorage.getItem(STORAGE_KEY);
    if(saved){ try{ data = JSON.parse(saved); }catch(e){ data = {}; } }
    
    // Inicializa todos os tanques com os peixes ornamentais e suas fotos
    if(!Object.keys(data).length){
      data = {
        '1A': { name: 'Molinésia Gold Black', image: 'molinesia gold black.webp' },
        '2A': { name: 'Platy Pingo de Ouro', image: 'Platy Pingo de Ouro.webp' },
        '3A': { name: 'Espada Abacaxi', image: 'espada abacaxi.webp' },
        '4A': { name: 'Molinésia Prata', image: 'Molinésia Prata.webp' },
        '5A': { name: 'Platy azul', image: 'Platy azul.webp' },
        '6A': { name: 'Molinésia Tangerina', image: 'molinesia-tangerina.jpg' },
        '1B': { name: 'Espada Tricolor', image: 'espada tricolor.jpg' },
        '2B': { name: 'Filhotes' },
        '3B': { name: 'Molinésia Balão Prata', image: 'Molinésia Balão Prata.webp' },
        '4B': { name: 'Platy Rubi', image: 'Platy Rubi.webp' },
        '5B': { name: 'Filhotes' },
        '6B': { name: 'Espada Bicolor Albino', image: 'Espada Bicolor Albino.webp' },
        '1C': { name: 'Molinésia Dálmata', image: 'Molinésia Dálmata.webp' },
        '2C': { name: 'Platy Sunset', image: 'Platy Sunset.webp' },
        '3C': { name: 'Molinésia Balão Dálmata', image: 'Molinésia Balão Dálmata.webp' },
        '4C': { name: 'Espada Sangue', image: 'Espada Sangue.webp' },
        '5C': { name: 'Platy Véu', image: 'Platy Véu.webp' },
        '6C': { name: 'Molinésia Milk', image: 'Molinésia Milk.webp' },
        '1D': { name: 'Espada Lira', image: 'Espada Lira.webp' },
        '2D': { name: 'Livre' },
        '3D': { name: 'Platy Abelhinha', image: 'Platy Abelhinha.webp' },
        '4D': { name: 'Molinesia tigre', image: 'Molinesia tigre.webp' },
        '5D': { name: 'Livre' },
        '6D': { name: 'Platy tricolor', image: 'Platy tricolor.webp' },
        '1E': { name: 'Platy Hawai', image: 'Platy Hawai.webp' },
        '2E': { name: 'Molinésia Negra Lira', image: 'Molinésia Negra Lira.webp' },
        '3E': { name: 'Livre' },
        '4E': { name: 'Livre' },
        '5E': { name: 'Molinesia negra', image: 'Molinesia negra.webp' },
        '6E': { name: 'Livre' }
      };
    }

    // Cria 30 células
    for(let r=1;r<=rowsCount;r++){
      for(let ci=0;ci<cols.length;ci++){
        const col = cols[ci];
        const id = `${r}${col}`; // por exemplo 1A, 1B, ... 6E

        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.dataset.id = id;

        const img = document.createElement('img');
        img.alt = `Tanque ${id}`;
        img.src = data[id] && data[id].image ? data[id].image : '';
        if(!img.src) img.style.display='none';

        const title = document.createElement('div'); title.className='title'; title.textContent = `Tanque ${id}`;
        const subtitle = document.createElement('div'); subtitle.className='subtitle'; subtitle.textContent = data[id] && data[id].name ? data[id].name : '— (vazio)';

        cell.appendChild(img);
        cell.appendChild(title);
        cell.appendChild(subtitle);

        // Ao clicar, abre modal para editar
        cell.addEventListener('click', ()=> openModal(id, subtitle, img));

        gridEl.appendChild(cell);
      }
    }

    // Modal controls
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const fishName = document.getElementById('fishName');
    const fishImage = document.getElementById('fishImage');
    const imagePreview = document.getElementById('imagePreview');
    const saveBtn = document.getElementById('saveBtn');
    const cancelBtn = document.getElementById('cancelBtn');

    let currentId = null;
    let currentPreviewDataUrl = null;

    function openModal(id, subtitleEl, imgEl){
      currentId = id;
      modalTitle.textContent = `Editar ${id}`;
      fishName.value = (data[id] && data[id].name) ? data[id].name : '';
      currentPreviewDataUrl = (data[id] && data[id].image) ? data[id].image : null;
      renderPreview();
      fishImage.value = null;
      modal.classList.add('open');

      // Foca no input
      setTimeout(()=>fishName.focus(),150);

      // save handler
      saveBtn.onclick = ()=>{
        const name = fishName.value.trim();
        if(currentPreviewDataUrl){
          data[currentId] = { name: name, image: currentPreviewDataUrl };
        } else if(name){
          data[currentId] = { name: name };
        } else {
          // sem nome e sem imagem => remove
          delete data[currentId];
        }
        writeToCell(currentId);
        saveToLocal();
        closeModal();
      };
    }

    cancelBtn.onclick = ()=> closeModal();
    modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });

    function closeModal(){ modal.classList.remove('open'); currentId = null; currentPreviewDataUrl = null; fishImage.value = null; }

    // Quando usuário seleciona arquivo, converte em dataURL (local)
    fishImage.addEventListener('change', (e)=>{
      const f = e.target.files && e.target.files[0];
      if(!f) return;
      const reader = new FileReader();
      reader.onload = function(ev){ currentPreviewDataUrl = ev.target.result; renderPreview(); };
      reader.readAsDataURL(f);
    });

    function renderPreview(){
      imagePreview.innerHTML = '';
      if(currentPreviewDataUrl){
        const i = document.createElement('img'); i.src = currentPreviewDataUrl; imagePreview.appendChild(i);
      } else {
        imagePreview.textContent = 'Sem imagem';
      }
    }

    // atualiza célula na tela a partir do data
    function writeToCell(id){
      const cell = document.querySelector(`.cell[data-id='${id}']`);
      if(!cell) return;
      const subtitle = cell.querySelector('.subtitle');
      const img = cell.querySelector('img');
      if(data[id] && data[id].name) subtitle.textContent = data[id].name; else subtitle.textContent = '— (vazio)';
      if(data[id] && data[id].image){ img.src = data[id].image; img.style.display='block'; } else { img.src=''; img.style.display='none'; }
    }

    // salva todo data no localStorage
    function saveToLocal(){
      try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); }catch(e){ alert('Erro ao salvar localmente. Talvez a imagem seja muito grande.'); }
    }

    // Se havia dados no loaded, atualiza células
    Object.keys(data).forEach(k=>writeToCell(k));

    // dica: você pode me mandar mais fotos/blocos que eu adiciono outras páginas/abas
  </script>
</body>
</html>
